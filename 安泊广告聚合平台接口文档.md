# 1.引言 #

## 1. 文档概述 ##

对于接入广告聚合平台的第三方公司，由我方对接同学通过CA中心为第三方公司申请公私钥，第三方公司获取公私钥后，可以使用本文档提供的开放接口。

## 2. 阅读对象 ##

接入广告聚合平台的第三方公司开发人员。

## 3. 接口规范 ##

### 3.1. 调用方

请求报文按照语义使用GET、POST、PUT、DELETE与服务端通信，在HTTP Header标注调用方身份信息，格式为：
*Uni-Source：商户标识/运行环境*

>商户标识：商户的PartnerId

>运行环境可选值：Android、iOS、H5、Server(当代码运行在服务器上时)

### 3.2.服务方

#### 3.2.1. 返回报文

返回报文封装为JSON格式，为：
*格式1（map）：*

```json
{
    "status":"20000000",
    "message":"OK",
    "result":{
        "col_1":"val_1",
        "col_2":"val_2"
    },
    "info":"xxx"
}
```

*格式2（list[map]）：*

```json
{
    "status":"20000000",
    "message":"OK",
    "result":[
        {
            "col_1":"val_1",
            "col_2":"val_2"
        },
        {
            "col_1":"val_1",
            "col_2":"val_2"
        }
    ],
    "info":"xxx"
}
```



*<font color=gray size=1>注：message是给用户看的，info是给开发看的；字段的排序上尽量保证字段顺序固定。</font>*

>如果result是密文，需要增加header属性Content-Encrypt，目前提供的方式为ECC：

><font color=gray size=1>HTTP Header </font>

>*Content-Encrypt:ECC*

#### 3.2.2. 返回码规范

返回码长度为8位，以字符串返回，每位的用意为：
>第一位是HTTP语义，正常返回2开头，可预期的客户端错误返回4开头，可预期的服务端错误5开头

>第二、第三位，一级错误分类

>第四、五位，二级错误分类

>第六、七位、八位，业务分类

### 3.3. 其他

header名字中不允许使用下划线；
平台提供有健康检查的接口，供第三方检查可用性：<font color=blue size=2>[GET]</font> */health*

# 2. 接口说明

## 1.创建账户信息

### 1.1.业务功能

创建帐户信息：根据用户名称，用户所在地址，主体类型，银行账户名称，银行名称，银行帐号创建帐户信息，返回partnerId。

### 1.2.业务规则

<font color=blue size=2>[POST]</font> */v1/account/*

### 1.3.请求参数

| **参数**           | **名称**     | **类型** | **长度** | **约束** | **说明**                   |
| ------------------ | ------------ | -------- | -------- | -------- | -------------------------- |
| Map<String,String> |              |          |          |          |                            |
| name               | 用户名称     | String   | 64       | 必填     |                            |
| address            | 所在地址     | String   | 64       | 必填     |                            |
| accountType        | 账户类型     | Int      | 1        | 必填     | 字典项：0:公司；1:个人     |
| accountName        | 银行账户名称 | String   | 32       | 必填     |                            |
| bankName           | 银行名称     | String   | 64       | 必填     |                            |
| accountNo          | 银行帐号     | String   | 64       | 必填     |                            |
| publicKey          | 公钥         | String   | 64       | 必填     | 由我司CA认证中心生成       |
| sign               | 签名         | String   | 64       | 必填     | ECC签名，根据SDK和密钥生成 |

### 1.1.请求参数示例

```json
{
    "name":"张三",
    "address":"北京市朝阳区中电发展大厦",
    "accountType":1,
    "accountName":"张三",
    "bankName":"招商银行",
    "accountNo":"6225888888888888",
    "publicKey":"WER45YUIO",
    "sign":"DFHGRTHERT"
}
```



### 1.2.响应参数

| **参数**    | **名称**     | **类型** | **长度** | **约束** | **说明**                     |
| ----------- | ------------ | -------- | -------- | -------- | ---------------------------- |
| status      | 响应码       | String   |          |          | 20000000 :成功 其它失败      |
| message     | 相应描述     | String   |          |          | 可以展示给用户               |
| info        | 详细信息     | String   |          |          | 供开发人员定位问题           |
| result      | 响应扩展     | Map      |          |          |                              |
| Map说明     |              |          |          |          |                              |
| partnerId   | 流量主ID     | String   | 10       | 必填     | 由账户信息做种子生成，唯一值 |
| name        | 用户名称     | String   | 64       |          |                              |
| address     | 所在地址     | String   | 64       |          |                              |
| accountType | 账户类型     | Int      | 1        |          |                              |
| accountName | 银行账户名称 | String   | 32       |          |                              |
| bankName    | 银行名称     | String   | 64       |          |                              |
| accountNo   | 银行帐号     | String   | 64       |          |                              |

 

### 1.3.响应参数示例

 ```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":{
        "name":"张三",
        "address":"北京市朝阳区中电发展大厦",
        "accountType":1,
        "accountName":"张三",
        "bankName":"招商银行",
        "accountNo":"6225888888888888",
        "partnerId":"5555999966"
    }
}
 ```



## 2.更新账户信息 

 

### 2.1.业务功能

更新账户信息：根据partnerId更新用户名称，用户所在地址，主体类型，银行账户名称，银行名称，银行帐号。

### 2.2.业务规则

<font color=blue size=2>[PUT]</font> */v1/account/*

### 2.3.请求参数

| **参数**           | **名称**     | **类型** | **长度** | **约束** | **说明**                   |
| ------------------ | ------------ | -------- | -------- | -------- | -------------------------- |
| Map<String,String> |              |          |          |          |                            |
| name               | 用户名称     | String   | 64       | 非必填   |                            |
| address            | 所在地址     | String   | 64       | 非必填   |                            |
| accountType        | 账户类型     | Int      | 1        | 非必填   | 字典项：0:公司；1:个人     |
| accountName        | 银行账户名称 | String   | 32       | 非必填   |                            |
| bankName           | 银行名称     | String   | 64       | 非必填   |                            |
| accountNo          | 银行帐号     | String   | 64       | 非必填   |                            |
| partnerId          | 流量主ID     | String   | 10       | 必填     |                            |
| sign               | 签名         | String   | 64       | 必填     | ECC签名，根据SDK和密钥生成 |

 

### 2.4.请求参数示例

```json
{
    "address":"北京市朝阳区国贸大厦",
    "accountNo":"6225888888889999",
    "partnerId":"5555999966",
    "sign":"DFHGRTHERT"
}
```



### 2.5.响应参数

| **参数**    | **名称**     | **类型** | **长度** | **约束** | **说明**                                   |
| ----------- | ------------ | -------- | -------- | -------- | ------------------------------------------ |
| status      | 响应码       | String   |          |          | 20000000 :成功 其它失败                    |
| message     | 相应描述     | String   |          |          | 可以展示给用户                             |
| info        | 详细信息     | String   |          |          | 供开发人员定位问题                         |
| result      | 响应扩展     | Map      |          |          |                                            |
| Map说明     |              |          |          |          |                                            |
| name        | 用户名称     | String   | 64       |          | 有更新，则返回更新值；无更新，则无返回值。 |
| address     | 所在地址     | String   | 64       |          | 有更新，则返回更新值；无更新，则无返回值。 |
| accountType | 账户类型     | Int      | 1        |          | 有更新，则返回更新值；无更新，则无返回值。 |
| accountName | 银行账户名称 | String   | 32       |          | 有更新，则返回更新值；无更新，则无返回值。 |
| bankName    | 银行名称     | String   | 64       |          | 有更新，则返回更新值；无更新，则无返回值。 |
| accountNo   | 银行帐号     | String   | 64       |          | 有更新，则返回更新值；无更新，则无返回值。 |

 

### 2.6.响应参数示例

```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":{
        "address":"北京市朝阳区国贸大厦",
        "accountNo":"6225888888889999"
    }
}
```



## 3.新增车场信息

 

### 3.1.业务功能

根据车场名称，城市ID，车场状态，流量主ID添加车场信息。

### 3.2.业务规则

<font color=blue size=2>[POST]</font> */v1/park/*

### 3.3.请求参数

| **参数**           | **名称** | **类型** | **长度** | **约束** | **说明**                          |
| ------------------ | -------- | -------- | -------- | -------- | --------------------------------- |
| Map<String,String> |          |          |          |          |                                   |
| parkName           | 车场名称 | String   | 64       | 必填     |                                   |
| cityId             | 城市ID   | String   | 16       | 必填     | 字典项：  "010"："北京"           |
| status             | 车场状态 | Int      | 1        | 非必填   | 字典项：(默认1)  0：停用，1：启用 |
| partnerId          | 流量主ID | String   | 10       | 必填     |                                   |
| sign               | 签名     | String   | 64       | 必填     | ECC签名，根据SDK和密钥生成        |

 

### 3.4.请求参数示例

```json
{
    "parkName":"中电发展大厦停车场",
    "cityId":"010",
    "partnerId":"5555999966",
    "sign":"DFHGRTHERT"
}
```



### 3.5.响应参数

| **参数**  | **名称** | **类型** | **长度** | **约束** | **说明**                   |
| --------- | -------- | -------- | -------- | -------- | -------------------------- |
| status    | 响应码   | String   |          |          | 20000000 :成功 其它失败    |
| message   | 相应描述 | String   |          |          | 可以展示给用户             |
| info      | 详细信息 | String   |          |          | 供开发人员定位问题         |
| result    | 响应扩展 | Map      |          |          |                            |
| Map说明   |          |          |          |          |                            |
| parkId    | 车场ID   | String   |          | 必填     | 城市区号+日期+序号         |
| parkName  | 车场名称 | String   |          |          |                            |
| cityId    | 城市ID   | String   |          |          | 字典项：  "010"："北京"    |
| status    | 车场状态 | Int      |          |          | 字典项：  0：停用，1：启用 |
| partnerId | 流量主ID | String   |          |          |                            |

 

### 3.6.响应参数示例

 ```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":{
        "parkId":"0102020022055555",
        "parkName":"中电发展大厦停车场",
        "cityId":"010",
        "status":1,
        "partnerId":"5555999966"
    }
}
 ```

 

## 4.更新车场信息

 

### 4.1.业务功能

根据车场ID，车场名称，城市ID，车场状态，流量主ID更新车场信息。

### 4.2.业务规则

<font color=blue size=2>[PUT]</font> */v1/park/*

### 4.3.请求参数

| **参数**           | **名称** | **类型** | **长度** | **约束** | **说明**                   |
| ------------------ | -------- | -------- | -------- | -------- | -------------------------- |
| Map<String,String> |          |          |          |          |                            |
| parkName           | 车场名称 | String   | 64       | 非必填   |                            |
| cityId             | 城市ID   | String   | 16       | 非必填   | 字典项：  "010"："北京"    |
| status             | 车场状态 | Int      | 1        | 非必填   | 字典项：  0：停用，1：启用 |
| partnerId          | 流量主ID | String   | 10       | 必填     |                            |
| parkId             | 车场ID   | String   | 16       | 必填     |                            |
| sign               | 签名     | String   | 64       | 必填     | ECC签名，根据SDK和密钥生成 |



### 4.4.请求参数示例

```json
{
    "parkName":"上海金茂大厦停车场",
    "cityId":"021",
    "parkId":"0102020022055555",
    "partnerId":"0102020021814360900001",
    "sign":"DFHGRTHERT"
}
```



### 4.5.响应参数

| **参数** | **名称** | **类型** | **长度** | **约束** | **说明**                                   |
| -------- | -------- | -------- | -------- | -------- | ------------------------------------------ |
| status   | 响应码   | String   |          |          | 20000000 :成功 其它失败                    |
| message  | 相应描述 | String   |          |          | 可以展示给用户                             |
| info     | 详细信息 | String   |          |          | 供开发人员定位问题                         |
| result   | 响应扩展 | Map      |          |          |                                            |
| Map说明  |          |          |          |          |                                            |
| parkName | 车场名称 | String   |          |          | 有更新，则返回更新值；无更新，则无返回值。 |
| cityId   | 城市ID   | String   |          |          | 有更新，则返回更新值；无更新，则无返回值。 |
| status   | 车场状态 | Int      |          |          | 有更新，则返回更新值；无更新，则无返回值。 |

 

### 4.6.响应参数示例

```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":{
        "parkName":"上海金茂大厦停车场",
        "cityId":"021"
    }
}
```



## 5.获取车场信息

 

### 5.1.业务功能

根据车场ID，流量主ID获取车场信息。

### 5.2.业务规则

<font color=blue size=2>[GET]</font> */v1/park/*

### 5.3.请求参数

| **参数**           | **名称** | **类型** | **长度** | **约束** | **说明** |
| ------------------ | -------- | -------- | -------- | -------- | -------- |
| Map<String,String> |          |          |          |          |          |
| parkId             | 车场ID   | String   | 16       | 非必填   |          |
| partnerId          | 流量主ID | String   | 10       | 必填     |          |



### 5.4.请求参数示例

*格式1：*

```json
{
    "partnerId":"5555999966",
    "parkId":"0102020022055555"
}
```

*格式2：*

```json
{
    "partnerId":"5555999966"
}
```



### 5.5.响应参数

| **参数**      | **名称** | **类型** | **长度** | **约束** | **说明**                   |
| ------------- | -------- | -------- | -------- | -------- | -------------------------- |
| status        | 响应码   | String   |          |          | 20000000 :成功 其它失败    |
| message       | 相应描述 | String   |          |          | 可以展示给用户             |
| info          | 详细信息 | String   |          |          | 供开发人员定位问题         |
| result        | 响应扩展 | Map      |          |          |                            |
| List<Map>说明 |          |          |          |          |                            |
| parkId        | 车场ID   | String   |          |          | 城市区号+日期+序号         |
| parkName      | 车场名称 | String   |          |          |                            |
| cityId        | 城市ID   | String   |          |          | 字典项：  "010"："北京"    |
| status        | 车场状态 | Int      |          |          | 字典项：  0：停用，1：启用 |
| partnerId     | 流量主ID | String   |          |          |                            |



### 5.6.响应参数示例

*格式1:*

```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":[
        {
            "parkId":"0102020022055555",
            "parkName":"中电发展大厦停车场",
            "cityId":"010",
            "status":1,
            "partnerId":"5555999966"
        }
    ]
}
```

*格式2：*

```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":[
        {
            "parkId":"0102020022055555",
            "parkName":"中电发展大厦停车场",
            "cityId":"010",
            "status":0,
            "partnerId":"5555999966"
        },
        {
            "parkId":"0102020022066666",
            "parkName":"上海金茂大厦停车场",
            "cityId":"021",
            "status":0,
            "partnerId":"5555999966"
        }
    ]
}
```



## 6.更新广告位信息

### 6.1.业务功能

根据广告位ID数组，流量主ID，车场ID更新广告位信息。

### 6.2.业务规则

<font color=blue size=2>[PUT]</font> */v1/advert-pos/*

### 6.3.业务功能

根据广告位ID数组，流量主ID，车场ID更新广告位信息。

### 6.4.请求参数

| **参数**           | **名称**     | **类型** | **长度** | **约束** | **说明**                            |
| ------------------ | ------------ | -------- | -------- | -------- | ----------------------------------- |
| Map<String,String> |              |          |          |          |                                     |
| adPosIds           | 广告位ID数组 | String[] |          | 必填     | 字典项：  1：支付，2：入场，3：出场 |
| partnerId          | 流量主ID     | String   | 10       | 必填     | 唯一值                              |
| parkId             | 车场ID       | String   | 16       | 必填     |                                     |
| sign               | 签名         | String   | 64       | 必填     | ECC签名，根据SDK和密钥生成          |



### 6.5.请求参数示例

```json
{
    "adPosIds":[
        "1",
        "2"
    ],
    "parkId":"0102020022055555",
    "partnerId":"5555999966",
    "sign":"DFHGRTHERT"
}
```



### 6.6.响应参数

| **参数** | **名称** | **类型** | **长度** | **约束** | **说明**                            |
| -------- | -------- | -------- | -------- | -------- | ----------------------------------- |
| status   | 响应码   | String   |          |          | 20000000 :成功 其它失败             |
| message  | 相应描述 | String   |          |          | 可以展示给用户                      |
| info     | 详细信息 | String   |          |          | 供开发人员定位问题                  |
| result   | 响应扩展 | Map      |          |          |                                     |
| Map说明  |          |          |          |          |                                     |
| parkId   | 车场ID   | String   |          |          |                                     |
| adPosId  | 广告位ID | String   |          |          | 字典项：  1：支付，2：入场，3：出场 |

 

### 6.7.响应参数示例

 ```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":[{
		"parkId":"0102020022055555",
        "adPosId":"1"
    },{
		"parkId":"0102020022055555",
        "adPosId":"2"
    }]
}
 ```



## 7.获取广告位信息

### 7.1.业务功能

根据车场ID和流量主ID获取广告位信息。

### 7.2.业务规则

<font color=blue size=2>[GET]</font> */v1/advert-pos/*

### 7.3.请求参数

| **参数**           | **名称** | **类型** | **长度** | **约束** | **说明** |
| ------------------ | -------- | -------- | -------- | -------- | -------- |
| Map<String,String> |          |          |          |          |          |
| parkId             | 车场ID   | String   | 16       | 非必填   |          |
| partnerId          | 流量主ID | String   | 10       | 必填     | 唯一值   |



### 7.4.请求参数示例

```json
{
    "parkId":"0102020022055555",
    "partnerId":"5555999966"
}
```



### 7.5.响应参数

| **参数**      | **名称**   | **类型** | **长度** | **约束** | **说明**                      |
| ------------- | ---------- | -------- | -------- | -------- | ----------------------------- |
| status        | 响应码     | String   |          |          | 20000000 :成功 其它失败       |
| message       | 相应描述   | String   |          |          | 可以展示给用户                |
| info          | 详细信息   | String   |          |          | 供开发人员定位问题            |
| result        | 响应扩展   | Map      |          |          |                               |
| List<Map>说明 |            |          |          |          |                               |
| positionName  | 广告位名称 | String   |          |          |                               |
| adType        | 广告形式   | String   |          |          | 字典 0：文字链接，1：图文链接 |

 

### 7.6.响应参数示例

 ```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":[
        {
            "positionName":"支付",
            "adType":"0"
        },
        {
            "positionName":"出场",
            "adType":"1"
        },
        {
            "positionName":"入场",
            "adType":"1"
        }
    ]
}
 ```



## 8.获取广告

### 8.1.业务功能

根据车场ID和流量主ID获取广告信息。

### 8.2.业务规则

<font color=blue size=2>[GET]</font> */v1/advert/*

### 8.3.请求参数

| **参数**           | **名称** | **类型** | **长度** | **约束** | **说明** |
| ------------------ | -------- | -------- | -------- | -------- | -------- |
| Map<String,String> |          |          |          |          |          |
| parkId             | 车场ID   | String   | 16       | 非必填   |          |
| partnerId          | 流量主ID | String   | 10       | 必填     | 唯一值   |

 

### 8.4.请求参数示例

```json
{
    "parkId":"0102020022055555",
    "partnerId":"5555999966"
}
```



### 8.5.响应参数

| **参数**      | **名称** | **类型** | **长度** | **约束** | **说明**                      |
| ------------- | -------- | -------- | -------- | -------- | ----------------------------- |
| status        | 响应码   | String   |          |          | 20000000 :成功 其它失败       |
| message       | 相应描述 | String   |          |          | 可以展示给用户                |
| info          | 详细信息 | String   |          |          | 供开发人员定位问题            |
| result        | 响应扩展 | Map      |          |          |                               |
| List<Map>说明 |          |          |          |          |                               |
| content       | 广告内容 | String   |          |          |                               |
| url           | 链接地址 | String   |          |          |                               |
| adType        | 广告形式 | String   |          |          | 字典 0：文字链接，1：图文链接 |

 

### 8.6.响应参数示例

```json
{
    "status":"20000000",
    "message":"成功",
    "info":"ok",
    "result":[
        {
            "content":"我是文字",
            "url":"http:// site.com/1.html",
            "adType":"0"
        },
        {
            "content":"图片URL",
            "url":"http://site.com/image.png",
            "adType":"1"
        },
        {
            "content":"图片URL",
            "url":"http://site.com/image.png",
            "adType":"1"
        }
    ]
}
```



# 2. 附录

## 1.返回码

| **返回码** | **返回描述** |
| ---------- | ------------ |
| 20000000   | 成功         |

## 2.字典项

账户类型-acountType

| 编码 | **描述** |
| ---- | -------- |
| 0    | 公司     |
| 1    | 个人     |

 

车场状态-status

| 编码 | **描述** |
| ---- | -------- |
| 0    | 停用     |
| 1    | 启用     |

 

广告位ID-adPosIds

| 编码 | **描述** |
| ---- | -------- |
| 1    | 支付     |
| 2    | 入场     |
| 3    | 出场     |

 

 

 

广告形式-adType

| 编码 | **描述** |
| ---- | -------- |
| 0    | 文字链接 |
| 1    | 图文链接 |

 

城市ID-cityId

| 编码 | **描述** |
| ---- | -------- |
| 010  | 北京     |
